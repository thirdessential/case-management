(this["webpackJsonpdatta-able-rv18.0.4"]=this["webpackJsonpdatta-able-rv18.0.4"]||[]).push([[50],{317:function(e,t,a){"use strict";var n=a(0),l=a.n(n),s=a(242),o=a.n(s);class r extends n.Component{constructor(e){super(e),console.log("data in excel",e.dataSource)}render(){return console.log(this.props),l.a.createElement("div",null,l.a.createElement("table",{id:"matter",className:"d-none"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"S.No"),l.a.createElement("th",null,"Last Seen"),l.a.createElement("th",null,"Status"),l.a.createElement("th",null,"Due Date"),l.a.createElement("th",null,"ID"),l.a.createElement("th",null,"Client"),l.a.createElement("th",null,"Matter"),l.a.createElement("th",null,"Issue Date"),l.a.createElement("th",null,"Balance"))),l.a.createElement("tbody",null,this.props.dataSource.map((e,t)=>l.a.createElement("tr",{key:t},l.a.createElement("td",null,t+1),l.a.createElement("td",null,e.lastSeen),l.a.createElement("td",null,e.status),l.a.createElement("th",null,e.dueDate),l.a.createElement("th",null,e.id),l.a.createElement("th",null,e.client),l.a.createElement("th",null,e.matter),l.a.createElement("th",null,e.issueDate),l.a.createElement("th",null,e.balance))))),l.a.createElement(o.a,{className:"btn btn-outline-primary btn-sm excel-button",table:"matter",filename:"Bills",sheet:"Sheet",buttonText:"Export to Excel"}))}}t.a=r},614:function(e,t,a){"use strict";a.r(t);var n=a(225),l=a.n(n),s=a(226),o=a(221),r=a(0),c=a.n(r),i=a(3),m=a(946),d=a(153),u=a(1001),p=a(268),h=a(8),b=a(973),E=a(728),g=a(110),y=a(1004),f=a(989),C=a(996),k=a(230),S=a.n(k),j=(a(231),a(999)),x=a(13),v=a.n(x),D=a(242),N=a.n(D);class O extends r.Component{constructor(e){super(e),console.log("data in excel",e.dataSource)}render(){return console.log(this.props),c.a.createElement("div",null,c.a.createElement("table",{id:"matter",className:"d-none"},c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",null,"S.No"),c.a.createElement("th",null,"Hours"),c.a.createElement("th",null,"type"),c.a.createElement("th",null,"Time"),c.a.createElement("th",null,"Date"),c.a.createElement("th",null,"Subject"),c.a.createElement("th",null,"Matter"),c.a.createElement("th",null,"from"),c.a.createElement("th",null,"to"))),c.a.createElement("tbody",null,this.props.dataSource.map((e,t)=>c.a.createElement("tr",{key:t},c.a.createElement("td",null,t+1),c.a.createElement("td",null,e.addTime),c.a.createElement("td",null,e.logType),c.a.createElement("td",null,e.time),c.a.createElement("td",null,e.date),c.a.createElement("td",null,e.subject),c.a.createElement("td",null,e.matter),c.a.createElement("td",null,e.from),c.a.createElement("td",null,e.to))))),c.a.createElement(N.a,{className:"btn btn-outline-primary btn-sm excel-button",table:"matter",filename:"Communications",sheet:"Sheet",buttonText:"Export to Excel"}))}}var I=O;let w="",T={},L={},F={},P=null,_=null,M=null,G=null,B=null;const A=JSON.parse(window.localStorage.getItem("Case.user")),U=A.token.user.firstName+" "+A.token.user.lastName;console.log(A.token.user);class V extends c.a.Component{constructor(e){super(e),this.convertTime=e=>{var t=new Date(e).toUTCString();return new Date(t+" UTC")},this.showModal=e=>{"secure"===e?this.setState({secure:!0}):"email"===e?this.setState({email:!0}):"phone"===e&&this.setState({phone:!0})},this.handleOk=e=>{if(g.a.destroy(),""!==w)g.a.error({message:"Invalid time,  Please enter time in the format : HH:MM:SS"});else if(""==this.state.data.subject)g.a.error({message:"Please add a subject"});else if(""==this.state.data.body)g.a.error({message:"Please add a body"});else if(this.setState({disable:!0}),this.state.editEmail||this.state.editPhone){let t=this.state.data;console.log(t),null==G&&(t.from=t.fromId),null==B&&(t.to=t.toId),"email"===e?(t.logType="email",this.setState({email:!1})):"phone"===e&&(t.logType="phone",this.setState({phone:!1})),t.userId=this.props.userId,console.log(t),i.b.post("/communication/edit/"+this.state.data.id,t).then(e=>{console.log(e),this.componentDidMount(),this.setState({disable:!1}),g.a.success({message:"Log Edited !"})}).catch(e=>{g.a.error({message:"Failed"})}).then(()=>{v.a.findDOMNode(this.messageForm).reset(),M=null,G=null,B=null,this.setState({editPhone:!1,editEmail:!1,disable:!1,data:{billable:!0,nonBillable:!1,date:"",qty:"1.0",rate:"",invoice:"Unbilled"}}),setTimeout(()=>{},1500)})}else{let t=this.state.data;"email"===e?(t.logType="email",this.setState({email:!1})):"phone"===e&&(t.logType="phone",this.setState({phone:!1})),t.userId=this.props.userId,console.log(t),i.b.post("/communication/create",t).then(e=>{console.log(e),this.setState({disable:!1}),this.componentDidMount(),g.a.success({message:"Log Added !"})}).catch(e=>{g.a.error({message:"Failed"})}).then(()=>{v.a.findDOMNode(this.messageForm).reset()})}},this.handleSecure=()=>{if(g.a.destroy(),""==this.state.data.to)g.a.error({message:"Please add a contact to send message"});else if(""==this.state.data.subject)g.a.error({message:"Please add a subject"});else if(""==this.state.data.body)g.a.error({message:"Please add a body"});else if(this.setState({disable:!0}),this.state.editSecure){let e=this.state.data;e.logType="secure",e.userId=this.props.userId,console.log(e),i.b.post("/communication/edit/"+this.state.data.id,e).then(e=>{console.log(e),this.componentDidMount(),this.setState({disable:!1}),g.a.success({message:"Log Edited !"})}).catch(e=>{g.a.error({message:"Failed"})}).then(()=>{v.a.findDOMNode(this.messageForm).reset(),this.setState({editSecure:!1,secure:!1,disable:!1,data:{billable:!0,nonBillable:!1,date:"",to:"",qty:"1.0",rate:"",invoice:"Unbilled"}}),setTimeout(()=>{},1500)})}else{let e=this.state.data;e.logType="secure",e.userId=this.props.userId,e.time=(new Date).getHours()+":"+(new Date).getMinutes(),e.from=A.token.user._id,console.log(e),i.b.get("/contact/view/".concat(e.to)).then(t=>{console.log(t);let a=0!=t.data.data.emailAddress.length?t.data.data.emailAddress[0].emailAddress:"",n=0!=t.data.data.phone.length?t.data.data.phone[0].phone:"";console.log(e);let l={to:a,subject:e.subject,text:e.body,date:new Date},s={mobile:n,content:e.body};console.log(l),console.log(s),""!==n&&i.b.post("/communication/sendsms",s).then(e=>{console.log(e),g.a.success({message:"SMS Sent"})}).catch(e=>{console.log(e),g.a.error({message:"Failed to send the sms"})}),""!==a&&i.b.post("/communication/sendemail",l).then(t=>{console.log(t),g.a.success({message:"Email Sent"}),i.b.post("/communication/create",e).then(e=>{console.log(e),this.componentDidMount(),g.a.success({message:"Log Added !"})}).catch(e=>{g.a.error({message:"Failed"})}).then(()=>{this.setState({disable:!1,secure:!1,editSecure:!1}),v.a.findDOMNode(this.messageForm).reset()})}).catch(e=>{console.log(e),g.a.error({message:"Failed to send the email"})})})}},this.handleCancel=e=>{M=null,G=null,B=null,"secure"===e?(this.setState({secure:!1,editSecure:!1,disable:!1,data:{subject:"",body:"",to:"",from:U}}),console.log(this.state)):"email"===e?(this.setState({email:!1,phone:!1,disable:!1,editEmail:!1,editSecure:!1,secure:!1,data:{subject:"",body:"",to:"",from:U}}),console.log(this.state)):"phone"===e&&(this.setState({phone:!1,email:!1,editPhone:!1,disable:!1,data:{subject:"",body:"",to:"",from:U}}),console.log(this.state)),setTimeout(()=>{},500)},this.state={phone:!1,email:!1,secure:!1,tableData:[],data:{subject:"",body:"",to:"",from:A.token.user._id},loading:!0,emailData:[],phoneData:[],completeData:[],tableData:[],editEmail:!1,editPhone:!1,editSecure:!1,disable:!1}}componentDidMount(){i.b.get("/matter/viewforuser/"+this.props.userId).then(e=>{T=e,P=e.data.data.map((e,t)=>c.a.createElement("option",{value:e._id},e.matterDescription))}).then(()=>{console.log(P),this.setState({option:P})}),i.b.get("/contact/viewforuser/"+this.props.userId).then(e=>{F=e,_=e.data.data.map((e,t)=>c.a.createElement("option",{id:t},e.firstName+" "+e.lastName))}).then(()=>{this.setState({contacts:_})}),i.b.get("/communication/viewforcontact/"+this.props.userId+"/"+this.props.id).then(e=>{L=e.data.data,console.log(L);let t=[],a=[],n=[];e.data.data.map((e,l)=>{const s={key:l,logType:e.logType,type:e.logType,id:e._id,addTime:e.addTime?e.addTime:"-",time:e.time?e.time:"",matterDesc:e.matter?e.matter.matterDescription:"-",matter:e.matter?e.matter._id:"",from:e.from?e.from.firstName+" "+e.from.lastName:"-",fromId:e.from?e.from._id:"",to:e.to?e.to.firstName+" "+e.to.lastName:"-",toId:e.to?e.to._id:"",subject:e.subject?e.subject:"-",body:e.body,date:e.date?e.date.substring(0,10):"-"};"email"!==e.logType&&"secure"!==e.logType||t.push(s),"secure"===e.logType&&(s.from=U,s.type="secure",s.logType="email",t.push(s)),"phone"===e.logType&&a.push(s),n.push(s)}),this.setState({completeData:n,phoneData:a,emailData:t,tableData:n,loading:!1})})}render(){const e=e=>{e.persist(),this.setState({touched:!1});const t=e.target,a=t.name,n=(t.id,t.value),l=t.selectedIndex;let s=this.state.data;if("matter"===a)l>=1?(M="",s[a]=n):s[a]="";else if("to"===a||"from"===a)console.log(T),l>=1?("to"===a?B="":G="",s[a]=F.data.data[l-1]._id):s[a]="";else if("addTime"===a){w="";var o=n;if(""==o||o.indexOf(":")<0)w="Inavlid Time",console.log(w);else{var r=o.split(":")[0],c=o.split(":")[1],i=o.split(":")[2];console.log(i),""==r||isNaN(r)?(w="Inavlid Time",console.log(w)):0==parseInt(r)&&(r="00"),""==c||isNaN(c)||parseInt(c)>59?(w="Inavlid Time",console.log(w)):0==parseInt(c)&&(c="00"),""==i||isNaN(i)?(w="Inavlid Time",console.log(w)):0==parseInt(i)&&(i="00"),o=r+":"+c+":"+i}s[a]=o,this.setState({data:s})}else console.log("inside last"),s[a]=n,this.setState({data:s});console.log(this.state)},t=e=>{console.log(e),"email"===e.logType?("secure"===e.type&&this.setState({editSecure:!0}),this.setState({editEmail:!0,data:e})):"phone"===e.logType&&this.setState({editPhone:!0,data:e}),console.log(e)},a=e=>{i.b.get("/communication/delete/"+e.id).then(e=>{this.componentDidMount(),g.a.success({message:"Log Deleted !"}),setTimeout(()=>{},1500)}).catch(e=>{g.a.error({message:"Failed to delete"})})},n=e=>{"email"===e?this.setState({tableData:this.state.emailData}):"phone"===e?this.setState({tableData:this.state.phoneData}):"all"===e&&this.setState({tableData:this.state.completeData})},l=[{title:"Hours",dataIndex:"addTime",key:"addTime"},{title:"Type",dataIndex:"logType",key:"logType"},{title:"Time",dataIndex:"time",key:"time"},{title:"Date",dataIndex:"date",key:"date"},{title:"Subject",dataIndex:"subject",key:"subject"},{title:"Matter",dataIndex:"matterDesc",key:"matterDesc"},{title:"From",dataIndex:"from",key:"from"},{title:"To",dataIndex:"to",key:"to"},{title:"Edit",dataIndex:"edit",key:"_id",render:(e,a)=>c.a.createElement(p.a,{variant:"danger",onClick:()=>t(a)},"Edit")},{title:"Delete",dataIndex:"delete",key:"_id",render:(e,t)=>c.a.createElement(y.a,{title:"Are you sure delete this Log?",onConfirm:()=>a(t),okText:"Yes",cancelText:"No"},c.a.createElement(p.a,{danger:!0},"Delete"))}];return c.a.createElement(d.a,{size:"large",spinning:this.state.loading},c.a.createElement("div",{className:"p-2 "},c.a.createElement("div",{className:"d-flex mb-2 title-component-header"},c.a.createElement("div",{className:"title-header-name"},c.a.createElement("h5",null,"Communication")),c.a.createElement("div",{className:"d-flex extra-iteam-div"},c.a.createElement("button",{className:"btn  btn-outline-primary   btn-sm",onClick:()=>{const e=new S.a("portrait","pt","A4");e.setFontSize(15);let t=[];this.state.tableData.map((e,a)=>{const n=[e.addTime,e.logType,e.time,e.Date,e.subject,e.matter,e.from,e.to];t.push(n)});let a={startY:50,head:[["Hours","Type","Time","Date","Subject","Matter","From","To"]],body:t};e.text("communication",40,40),e.autoTable(a),e.save("communications.pdf")}},"Export to PDF"),c.a.createElement(I,{dataSource:this.state.tableData||[]}),c.a.createElement("button",{className:"btn  btn-outline-primary   btn-sm",onClick:()=>this.showModal("secure")},"New secure message"),c.a.createElement("button",{className:"btn  btn-outline-primary   btn-sm",onClick:()=>this.showModal("email")},"New Email Log"),c.a.createElement("button",{className:"btn  btn-outline-primary   btn-sm",onClick:()=>this.showModal("phone")},"New Phone Log"))),c.a.createElement(u.a,{bodyStyle:{padding:"14px 10px 0px 10px"}},c.a.createElement("div",{style:{display:"flex","flex-wrap":"wrap","justify-content":"space-between"}},c.a.createElement("div",{className:"mb-2"},c.a.createElement(p.a,{onClick:()=>n("all")},"All"),c.a.createElement(p.a,{onClick:()=>n("email")},"Email"),c.a.createElement(p.a,{onClick:()=>n("phone")},"Phone")))),c.a.createElement(u.a,{bodyStyle:{padding:"0px"},className:"overflow-auto"},c.a.createElement(f.a,{columns:l,dataSource:this.state.tableData})),c.a.createElement(C.a,{title:this.state.secure?"Edit Secure message":"New Secure Message",visible:this.state.secure,onOk:this.handleSecure,onCancel:()=>this.handleCancel("secure"),footer:[c.a.createElement(p.a,{onClick:()=>this.handleCancel("secure")},"Cancel"),c.a.createElement(p.a,{type:"primary",disabled:this.state.disable,onClick:this.handleSecure},this.state.editSecure?"Update Log":"Send")]},c.a.createElement(j.a,{id:"myForm",className:"form",ref:e=>this.messageForm=e},c.a.createElement(b.a,null,c.a.createElement(E.a,{sm:!0},c.a.createElement(j.a.Group,null,c.a.createElement(j.a.Label,null,"Matter"),c.a.createElement(j.a.Control,{as:"select",name:"matter",placeholder:"Matter",onChange:e},c.a.createElement("option",null,"Select a matter"),this.state.option)))),c.a.createElement(b.a,null,c.a.createElement(E.a,{sm:!0},c.a.createElement(j.a.Group,null,c.a.createElement(j.a.Label,null,"From"),c.a.createElement(j.a.Control,{as:"select",name:"from",placeholder:"Select a contact",onChange:e},c.a.createElement("option",null,U)))),c.a.createElement(E.a,{sm:!0},c.a.createElement(j.a.Group,null,c.a.createElement(j.a.Label,null,"To"),c.a.createElement(j.a.Control,{as:"select",name:"to",placeholder:"Select a contact",onChange:e},c.a.createElement("option",null,"Select a contact"),this.state.contacts)))),c.a.createElement(j.a.Group,{controlId:"subject"},c.a.createElement(j.a.Label,null,"Subject"),c.a.createElement(j.a.Control,{name:"subject",rows:"3",placeholder:"subject",onChange:e})),c.a.createElement(j.a.Group,{controlId:"body"},c.a.createElement(j.a.Label,null,"Body"),c.a.createElement(j.a.Control,{name:"body",as:"textarea",rows:"3",placeholder:"body",onChange:e})))),c.a.createElement(C.a,{title:this.state.editEmail?"Edit email log":"Add a email log",visible:this.state.editEmail,onOk:()=>this.handleOk("email"),onCancel:()=>this.handleCancel("email"),footer:[c.a.createElement(p.a,{onClick:()=>this.handleCancel("email")},"Cancel"),c.a.createElement(p.a,{type:"primary",disabled:this.state.disable,onClick:()=>this.handleOk("email")},this.state.editEmail?"Edit Log":"Save Log")]},this.state.editEmail?c.a.createElement(j.a,{id:"myForm",className:"form",ref:e=>this.messageForm=e},c.a.createElement(b.a,null,c.a.createElement(E.a,{sm:!0},c.a.createElement(j.a.Group,null,c.a.createElement(j.a.Label,null,"Matter"),c.a.createElement(j.a.Control,{as:"select",name:"matter",defaultValue:this.state.data.matter,onChange:e},c.a.createElement("option",null,"Select a matter"),this.state.option)))),c.a.createElement(b.a,null,c.a.createElement(E.a,{sm:!0},c.a.createElement(j.a.Group,null,c.a.createElement(j.a.Label,null,"From"),c.a.createElement(j.a.Control,{as:"select",name:"from",defaultValue:this.state.data.from,onChange:e},c.a.createElement("option",null,"Select a contact"),this.state.editSecure?c.a.createElement("option",null,U):this.state.contacts))),c.a.createElement(E.a,{sm:!0},c.a.createElement(j.a.Group,null,c.a.createElement(j.a.Label,null,"To"),c.a.createElement(j.a.Control,{as:"select",name:"to",defaultValue:this.state.data.to,onChange:e},c.a.createElement("option",null,"Select a contact"),this.state.contacts)))),c.a.createElement(b.a,null,c.a.createElement(E.a,{sm:!0},c.a.createElement(j.a.Group,{controlId:"date"},c.a.createElement(j.a.Label,null,"Time"),c.a.createElement(j.a.Control,{required:!0,type:"time",name:"time",defaultValue:this.state.data.time,onChange:e}))),c.a.createElement(E.a,{sm:!0},c.a.createElement(j.a.Group,{controlId:"date"},c.a.createElement(j.a.Label,null,"Date"),c.a.createElement(j.a.Control,{required:!0,type:"date",name:"date",defaultValue:this.state.data.date,onChange:e})))),c.a.createElement(j.a.Group,{controlId:"subject"},c.a.createElement(j.a.Label,null,"Subject"),c.a.createElement(j.a.Control,{name:"subject",rows:"3",defaultValue:this.state.data.subject,onChange:e})),c.a.createElement(j.a.Group,{controlId:"body"},c.a.createElement(j.a.Label,null,"Body"),c.a.createElement(j.a.Control,{name:"body",as:"textarea",rows:"3",defaultValue:this.state.data.body,onChange:e}))):null),c.a.createElement(C.a,{title:this.state.editEmail?"Edit email log":"Add a email log",visible:this.state.email,onOk:()=>this.handleOk("email"),onCancel:()=>this.handleCancel("email"),footer:[c.a.createElement(p.a,{onClick:()=>this.handleCancel("email")},"Cancel"),c.a.createElement(p.a,{type:"primary",disabled:this.state.disable,onClick:()=>this.handleOk("email")},this.state.editEmail?"Update Log":"Save Log")]},c.a.createElement(j.a,{id:"myForm",className:"form",ref:e=>this.messageForm=e},c.a.createElement(b.a,null,c.a.createElement(E.a,{sm:!0},c.a.createElement(j.a.Group,null,c.a.createElement(j.a.Label,null,"Matter"),c.a.createElement(j.a.Control,{as:"select",name:"matter",placeholder:"Matter",onChange:e},c.a.createElement("option",null,"Select a matter"),this.state.option)))),c.a.createElement(b.a,null,c.a.createElement(E.a,{sm:!0},c.a.createElement(j.a.Group,null,c.a.createElement(j.a.Label,null,"From"),c.a.createElement(j.a.Control,{as:"select",name:"from",placeholder:"Select a contact",onChange:e},c.a.createElement("option",null,"Select a contact"),this.state.contacts))),c.a.createElement(E.a,{sm:!0},c.a.createElement(j.a.Group,null,c.a.createElement(j.a.Label,null,"To"),c.a.createElement(j.a.Control,{as:"select",name:"to",placeholder:"Select a contact",onChange:e},c.a.createElement("option",null,"Select a contact"),this.state.contacts)))),c.a.createElement(b.a,null,c.a.createElement(E.a,{sm:!0},c.a.createElement(j.a.Group,{controlId:"date"},c.a.createElement(j.a.Label,null,"Time"),c.a.createElement(j.a.Control,{required:!0,type:"time",name:"time",placeholder:"Time",onChange:e}))),c.a.createElement(E.a,{sm:!0},c.a.createElement(j.a.Group,{controlId:"date"},c.a.createElement(j.a.Label,null,"Date"),c.a.createElement(j.a.Control,{required:!0,type:"date",name:"date",placeholder:"Date",onChange:e})))),c.a.createElement(j.a.Group,{controlId:"subject"},c.a.createElement(j.a.Label,null,"Subject"),c.a.createElement(j.a.Control,{name:"subject",rows:"3",placeholder:"subject",onChange:e})),c.a.createElement(j.a.Group,{controlId:"body"},c.a.createElement(j.a.Label,null,"Body"),c.a.createElement(j.a.Control,{name:"body",as:"textarea",rows:"3",placeholder:"body",onChange:e})))),c.a.createElement(C.a,{title:this.state.editPhone?"Edit phone log":"Add a phone log",visible:this.state.editPhone,onOk:()=>this.handleOk("phone"),onCancel:()=>this.handleCancel("phone"),footer:[c.a.createElement(p.a,{onClick:()=>this.handleCancel("phone")},"Cancel"),c.a.createElement(p.a,{type:"primary",disabled:this.state.disable,onClick:()=>this.handleOk("phone")},this.state.editPhone?"Edit Log":"Save Log")]},c.a.createElement(j.a,{id:"myForm",className:"form",ref:e=>this.messageForm=e},c.a.createElement(b.a,null,c.a.createElement(E.a,{sm:!0},c.a.createElement(j.a.Group,{controlId:"duration"},c.a.createElement(j.a.Label,null,"Duration"),c.a.createElement(j.a.Control,{type:"text",name:"addTime",defaultValue:this.state.data.addTime,onChange:e}))),c.a.createElement(E.a,{sm:!0},c.a.createElement(j.a.Group,null,c.a.createElement(j.a.Label,null,"Matter"),c.a.createElement(j.a.Control,{as:"select",name:"matter",defaultValue:this.state.data.matter,onChange:e},c.a.createElement("option",null,"Select a matter"),this.state.option)))),c.a.createElement(b.a,null,c.a.createElement(E.a,{sm:!0},c.a.createElement(j.a.Group,null,c.a.createElement(j.a.Label,null,"From"),c.a.createElement(j.a.Control,{as:"select",name:"from",defaultValue:this.state.data.from,onChange:e},c.a.createElement("option",null,"Select a contact"),this.state.contacts))),c.a.createElement(E.a,{sm:!0},c.a.createElement(j.a.Group,null,c.a.createElement(j.a.Label,null,"To"),c.a.createElement(j.a.Control,{as:"select",name:"to",defaultValue:this.state.data.to,onChange:e},c.a.createElement("option",null,"Select a contact"),this.state.contacts)))),c.a.createElement(b.a,null,c.a.createElement(E.a,{sm:!0},c.a.createElement(j.a.Group,{controlId:"date"},c.a.createElement(j.a.Label,null,"Time"),c.a.createElement(j.a.Control,{required:!0,type:"time",name:"time",defaultValue:this.state.data.time,onChange:e}))),c.a.createElement(E.a,{sm:!0},c.a.createElement(j.a.Group,{controlId:"date"},c.a.createElement(j.a.Label,null,"Date"),c.a.createElement(j.a.Control,{required:!0,type:"date",name:"date",defaultValue:this.state.data.date,onChange:e})))),c.a.createElement(j.a.Group,{controlId:"subject"},c.a.createElement(j.a.Label,null,"Subject"),c.a.createElement(j.a.Control,{name:"subject",rows:"3",defaultValue:this.state.data.subject,onChange:e})),c.a.createElement(j.a.Group,{controlId:"body"},c.a.createElement(j.a.Label,null,"Body"),c.a.createElement(j.a.Control,{name:"body",as:"textarea",rows:"3",defaultValue:this.state.data.body,onChange:e})))),c.a.createElement(C.a,{title:this.state.editPhone?"Edit phone log":"Add a phone log",visible:this.state.phone,onOk:()=>this.handleOk("phone"),onCancel:()=>this.handleCancel("phone"),footer:[c.a.createElement(p.a,{onClick:()=>this.handleCancel("phone")},"Cancel"),c.a.createElement(p.a,{type:"primary",disabled:this.state.disable,onClick:()=>this.handleOk("phone")},this.state.editPhone?"Update Log":"Save Log")]},c.a.createElement(j.a,{id:"myForm",className:"form",ref:e=>this.messageForm=e},c.a.createElement(b.a,null,c.a.createElement(E.a,{sm:!0},c.a.createElement(j.a.Group,{controlId:"duration"},c.a.createElement(j.a.Label,null,"Duration"),c.a.createElement(j.a.Control,{type:"text",name:"addTime",placeholder:"hh:mm:ss",onChange:e}))),c.a.createElement(E.a,{sm:!0},c.a.createElement(j.a.Group,null,c.a.createElement(j.a.Label,null,"Matter"),c.a.createElement(j.a.Control,{as:"select",name:"matter",placeholder:"Matter",onChange:e},c.a.createElement("option",null,"Select a matter"),this.state.option)))),c.a.createElement(b.a,null,c.a.createElement(E.a,{sm:!0},c.a.createElement(j.a.Group,null,c.a.createElement(j.a.Label,null,"From"),c.a.createElement(j.a.Control,{as:"select",name:"from",placeholder:"Select a contact",onChange:e},c.a.createElement("option",null,"Select a contact"),this.state.contacts))),c.a.createElement(E.a,{sm:!0},c.a.createElement(j.a.Group,null,c.a.createElement(j.a.Label,null,"To"),c.a.createElement(j.a.Control,{as:"select",name:"to",placeholder:"Select a contact",onChange:e},c.a.createElement("option",null,"Select a contact"),this.state.contacts)))),c.a.createElement(b.a,null,c.a.createElement(E.a,{sm:!0},c.a.createElement(j.a.Group,{controlId:"date"},c.a.createElement(j.a.Label,null,"Time"),c.a.createElement(j.a.Control,{required:!0,type:"time",name:"time",placeholder:"Time",onChange:e}))),c.a.createElement(E.a,{sm:!0},c.a.createElement(j.a.Group,{controlId:"date"},c.a.createElement(j.a.Label,null,"Date"),c.a.createElement(j.a.Control,{required:!0,type:"date",name:"date",placeholder:"Date",onChange:e})))),c.a.createElement(j.a.Group,{controlId:"subject"},c.a.createElement(j.a.Label,null,"Subject"),c.a.createElement(j.a.Control,{name:"subject",rows:"3",placeholder:"subject",onChange:e})),c.a.createElement(j.a.Group,{controlId:"body"},c.a.createElement(j.a.Label,null,"Body"),c.a.createElement(j.a.Control,{name:"body",as:"textarea",rows:"3",placeholder:"body",onChange:e}))))))}}var q=Object(h.b)(e=>({userId:e.user.token.user._id}))(V),H=a(975),Y=a(317);const z=m.a.TabPane;class R extends c.a.Component{constructor(){super(),this.handelBills=e=>{"record"===e&&this.props.history.push("/manage/billing/record")},this.state={tableData:[],draftBills:[],unpaidBills:[],paidBills:[],status:!1,loading:!0}}cancel(e){H.a.error("Canceled")}componentDidMount(){i.b.get("/billing/bill/viewforcontact/"+this.props.userId+"/"+this.props.id).then(e=>{console.log(e.data.data);let t=[],a=[],n=[],l=[];e.data.data.map((e,s)=>{const o={key:s,_id:e._id,lastSeen:e.lastSeen?e.lastSeen.substring(0,10):"-",status:e.status,dueDate:e.dueDate.substring(0,10),id:e.invoiceId?e.invoiceId:"-",client:e.client?e.client.firstName+" "+e.client.lastName:"-",matter:e.matter?e.matter.matterDescription:"-",issueDate:e.issueDate.substring(0,10),balance:parseFloat(e.balance).toFixed("2")};"Paid"==e.status&&a.push(o),"Unpaid"==e.status&&n.push(o),"draft"==e.status&&l.push(o),t.push(o)}),this.setState({tableData:t,paidBills:a,unpaidBills:n,draftBills:l,loading:!1})})}render(){const e=(e,t)=>{const a=e;delete a.matter,delete a.client,"fromDraft"===t?a.status="Unpaid":"fromUnpaid"===t&&(a.status="Paid"),i.b.post("/billing/bill/edit/"+e._id,a).then(a=>{if(console.log(a),"fromDraft"==t){const t=this.state;t.draftBills.splice(e.key,1),t.unpaidBills.push(a.data.data)}if("fromUnpaid"==t){const t=this.state;t.unpaidBills.splice(e.key,1),t.paidBills.push(a.data.data)}g.a.success({message:"Success"}),setTimeout(()=>{this.componentDidMount()},1e3)}).catch(e=>{console.log(e),g.a.error("Failed")})},t=e=>{i.b.get("/billing/bill/delete/"+e._id).then(e=>{console.log(e),this.componentDidMount(),g.a.success({message:"Bills Deleted !"}),setTimeout(()=>{},1500)}).catch(e=>{g.a.error({message:"Failed to delete"})})},a=[{title:"Action",dataIndex:"action",key:"action",render:(t,a)=>c.a.createElement(y.a,{title:"Approve this draft bill",onConfirm:()=>e(a,"fromDraft"),onCancel:this.cancel,okText:"Yes",cancelText:"No"},c.a.createElement(j.a.Check,{type:"checkbox"}))},{title:"Last Seen",dataIndex:"lastSeen",key:"lastSeen"},{title:"Status",dataIndex:"status",key:"status"},{title:"Due Date",dataIndex:"dueDate",key:"dueDate"},{title:"ID",dataIndex:"id",key:"id"},{title:"Client",dataIndex:"client",key:"client"},{title:"Matter",dataIndex:"matter",key:"matter"},{title:"Issue Date",dataIndex:"issueDate",key:"issueDate"},{title:"Balance",dataIndex:"balance",key:"balance"},{title:"Delete",dataIndex:"Delete",key:"Delete",render:(e,a)=>c.a.createElement(y.a,{title:"Are you sure you want to delete this bill ?",onConfirm:()=>t(a),onCancel:this.cancel,okText:"Yes",cancelText:"No"},c.a.createElement(p.a,{danger:!0},"Delete"))}],n=[{title:"Action",dataIndex:"action",key:"action",render:(t,a)=>c.a.createElement(y.a,{title:"Mark as Paid",onConfirm:()=>e(a,"fromUnpaid"),onCancel:this.cancel,okText:"Yes",cancelText:"No"},c.a.createElement(j.a.Check,{type:"checkbox"}))},{title:"Last Seen",dataIndex:"lastSeen",key:"lastSeen"},{title:"Status",dataIndex:"status",key:"status"},{title:"Due Date",dataIndex:"dueDate",key:"dueDate"},{title:"ID",dataIndex:"id",key:"id"},{title:"Client",dataIndex:"client",key:"client"},{title:"Matter",dataIndex:"matter",key:"matter"},{title:"Issue Date",dataIndex:"issueDate",key:"issueDate"},{title:"Balance",dataIndex:"balance",key:"balance"},{title:"Delete",dataIndex:"Delete",key:"Delete",render:(e,a)=>c.a.createElement(y.a,{title:"Are you sure you want to delete this bill ?",onConfirm:()=>t(a),onCancel:this.cancel,okText:"Yes",cancelText:"No"},c.a.createElement(p.a,{danger:!0},"Delete"))}],l=[{title:"Last Seen",dataIndex:"lastSeen",key:"lastSeen"},{title:"Status",dataIndex:"status",key:"status"},{title:"Due Date",dataIndex:"dueDate",key:"dueDate"},{title:"ID",dataIndex:"id",key:"id"},{title:"Client",dataIndex:"client",key:"client"},{title:"Matter",dataIndex:"matter",key:"matter"},{title:"Issue Date",dataIndex:"issueDate",key:"issueDate"},{title:"Balance",dataIndex:"balance",key:"balance"},{title:"Delete",dataIndex:"Delete",key:"Delete",render:(e,a)=>c.a.createElement(y.a,{title:"Are you sure you want to delete this bill ?",onConfirm:()=>t(a),onCancel:this.cancel,okText:"Yes",cancelText:"No"},c.a.createElement(p.a,{danger:!0},"Delete"))}];return c.a.createElement(d.a,{size:"large",spinning:this.state.loading},c.a.createElement("div",{className:"p-2 "},c.a.createElement("div",{className:"d-flex mb-2 title-component-header"},c.a.createElement("div",{className:"title-header-name"},c.a.createElement("h5",null,"Billing")),c.a.createElement("div",{className:"d-flex extra-iteam-div"},c.a.createElement("button",{className:"btn  btn-outline-primary   btn-sm",onClick:()=>{const e=new S.a("portrait","pt","A4");e.setFontSize(15);let t=[];this.state.tableData.map((e,a)=>{const n=[e.lastSeen,e.status,e.dueDate,e.id,e.client,e.matter,e.issueDate,e.balance];t.push(n)});let a={startY:50,head:[["Last Seen","Status","Due Date","ID","Client","Matter","Issue Date","Balance"]],body:t};e.text("Bills",40,40),e.autoTable(a),e.save("Bill.pdf")}},"Export to Pdf"),c.a.createElement(Y.a,{dataSource:this.state.tableData||[]}),c.a.createElement("button",{className:"btn  btn-outline-primary   btn-sm",onClick:this.props.handleRecordPayment},"Record Payment"),c.a.createElement("button",{className:"btn  btn-outline-primary   btn-sm",onClick:this.props.handleBills},"New Bills"))),c.a.createElement(u.a,null,c.a.createElement(m.a,{defaultActiveKey:"4",onChange:()=>{}},c.a.createElement(z,{tab:"Draft",key:"1"},c.a.createElement(f.a,{className:"table-responsive",dataSource:this.state.draftBills,columns:a})),c.a.createElement(z,{tab:"All",key:"4"},c.a.createElement(f.a,{className:"table-responsive",dataSource:this.state.tableData,columns:l})),c.a.createElement(z,{tab:"Unpaid",key:"3"},c.a.createElement(f.a,{className:"table-responsive",dataSource:this.state.unpaidBills,columns:n})),c.a.createElement(z,{tab:"Paid",key:"2"},c.a.createElement(f.a,{className:"table-responsive",dataSource:this.state.paidBills,columns:l}))))))}}var J=Object(h.b)(e=>({userId:e.user.token.user._id}))(R),K=a(1),W=a(467),Q=a(992),X=a(998),Z=a(613),$=a(620),ee=a(1008),te=a(1010),ae=a(1007),ne=a(237),le=a.n(ne);a(33);const se=W.a.Option,oe=m.a.TabPane;var re=e=>{const t=Object(r.useState)([]),a=Object(o.a)(t,2),n=a[0],u=a[1],b=Object(h.d)(e=>e.user.token.user._id),E=Object(r.useState)(!1),k=Object(o.a)(E,2),S=(k[0],k[1],Object(r.useState)([])),j=Object(o.a)(S,2),x=(j[0],j[1],Object(r.useState)({name:"",userId:"",documents:[]})),v=Object(o.a)(x,2),D=(v[0],v[1],Object(r.useState)([])),N=Object(o.a)(D,2),O=(N[0],N[1]),I=Object(r.useState)(!1),w=Object(o.a)(I,2),T=(w[0],w[1]),L=Object(r.useState)({name:"",userId:b,document:"",category:""}),F=Object(o.a)(L,2),P=(F[0],F[1]),_=Object(r.useState)(!1),M=Object(o.a)(_,2),G=M[0],B=M[1],A=Object(r.useState)(!1),U=Object(o.a)(A,2),V=U[0],q=U[1],H=Object(r.useState)("Document"),Y=Object(o.a)(H,2),z=(Y[0],Y[1],Object(r.useState)(!0)),R=Object(o.a)(z,2),J=R[0],ne=R[1],re=Object(r.useState)({name:"",userId:b}),ce=Object(o.a)(re,2),ie=ce[0],me=ce[1],de=Object(r.useState)(!1),ue=Object(o.a)(de,2),pe=(ue[0],ue[1],Object(r.useState)({document:"",_id:"",name:"",matter:"",contact:"",category:"",userId:b})),he=Object(o.a)(pe,2),be=(he[0],he[1],Object(r.useState)([])),Ee=Object(o.a)(be,2),ge=Ee[0],ye=Ee[1],fe=Object(r.useState)(!1),Ce=Object(o.a)(fe,2),ke=Ce[0],Se=Ce[1],je=Object(r.useState)({document:"",_id:"",name:"",matter:"",contact:"",category:""}),xe=Object(o.a)(je,2),ve=xe[0],De=xe[1],Ne=Object(r.useState)("Upload"),Oe=Object(o.a)(Ne,2),Ie=Oe[0],we=Oe[1],Te=Object(r.useState)([]),Le=Object(o.a)(Te,2),Fe=Le[0],Pe=Le[1],_e=Object(r.useState)([]),Me=Object(o.a)(_e,2),Ge=Me[0],Be=Me[1],Ae=Object(r.useState)(""),Ue=Object(o.a)(Ae,2),Ve=Ue[0],qe=Ue[1],He=Object(r.useState)([]),Ye=Object(o.a)(He,2),ze=Ye[0],Re=Ye[1],Je=Object(r.useState)(!1),Ke=Object(o.a)(Je,2),We=Ke[0],Qe=Ke[1],Xe=Object(r.useState)(""),Ze=Object(o.a)(Xe,2),$e=(Ze[0],Ze[1],Object(r.useState)([])),et=Object(o.a)($e,2),tt=(et[0],et[1],Object(r.useState)(!1)),at=Object(o.a)(tt,2),nt=(at[0],at[1],[{title:"Type",dataIndex:"type",key:"0"},{title:c.a.createElement("div",null,c.a.createElement(ae.a,{style:{"vertical-align":"revert"},onClick:()=>{Qe(!1===We)}}),c.a.createElement("span",{style:{paddingLeft:"8px"}}," Name "),We&&c.a.createElement("div",{style:{paddingTop:"10px"}},c.a.createElement("input",{placeholder:"Search",value:Ve,onChange:e=>{let t;qe(e.target.value),0!==e.target.value.length||""===e.target.value?(t=n.filter(t=>t.name.toLowerCase().includes(e.target.value.toLowerCase())),Re(t)):Re(n)}}))),dataIndex:"name",key:"1",render:e=>c.a.createElement(le.a,{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[Ve],autoEscape:!0,textToHighlight:e?e.toString():""})},{title:"Matter",dataIndex:"matter",key:"2"},{title:"Category",dataIndex:"category",key:"3"},{title:"Received Date",dataIndex:"receivedDate",key:"4",sortDirections:["descend","ascend"],sorter:(e,t)=>e.receivedDate>t.receivedDate},{title:"Last Edit",dataIndex:"lastEdit",key:"5",sortDirections:["descend","ascend"],sorter:(e,t)=>e.lastEdit>t.lastEdit},{title:"Edit",dataIndex:"edit",key:"6",render:(e,t)=>c.a.createElement(p.a,{className:"btn-outline-info ",onClick:()=>{it(t._id)}},"Edit")},{title:"Delete",dataIndex:"delete",key:"7",render:(e,t)=>c.a.createElement(y.a,{title:"Are you sure delete this Document?",onConfirm:()=>ct(t._id),onCancel:()=>{},okText:"Yes",cancelText:"No"},c.a.createElement(p.a,{className:" btn-outline-danger "},"Delete"))},{title:"Download",dataIndex:"download",key:"8",render:(e,t)=>c.a.createElement(p.a,{className:"btn-outline-primary ",onClick:()=>{rt(t)},icon:c.a.createElement(ee.a,null)},"Download")}]),lt=e=>t=>{console.log(e),console.log(t),"document"===e?(t.persist(),De(Object(K.a)(Object(K.a)({},ve),{},{document:t.target.files[0]}))):"category"===e?(ve["".concat(e)]=t,De(Object(K.a)({},ve))):"matter"===e?"Upload"===Ie?(console.log("from the uploads"),ve["".concat(e)]=t,De(Object(K.a)({},ve)),ft(t)):(console.log("from the edits"),i.b.get("/matter/view/".concat(t)).then(a=>{ve["".concat(e)]=a.data.data,De(Object(K.a)({},ve)),ft(t)})):(ve["".concat(e)]=t.target.value,De(Object(K.a)({},ve))),console.log(ve)},st=function(){var t=Object(s.a)(l.a.mark((function t(){var a,n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=[],n=[],t.next=4,i.b.get("/document/viewforcontact/"+b+"/"+e.id).then(e=>{console.log(e.data.data),e.data.data.map((e,t)=>{if(void 0==e.matter){const a={_id:e._id,key:t,document:e.document,category:e.category,name:e.name};n.push(a)}else"folder"!=e.type&&(a=[...a,Object(K.a)(Object(K.a)({},e),{},{type:"File",key:e._id,matter:null!==e.matter?e.matter.matterDescription:"-",receivedDate:yt(e.receivedDate),lastEdit:yt(e.lastEdit)})])})});case 4:return u(a),O(n),ne(!1),a=[],t.next=10,i.b.get("/matter/viewforuser/".concat(b)).then(e=>{e.data.data.map(e=>{a=[...a,Object(K.a)(Object(K.a)({},e),{},{key:e._id,client:null===e.client?{_id:"",updated_at:"",created_at:"-",userId:"-",title:"-",lastName:"-",firstName:"",__v:0,image:"",customFields:[{Email:"-"}],address:[],website:[],phone:[],emailAddress:[],company:["-"]}:e.client})]})});case 10:Pe(a);case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),ot=function(){var e=Object(s.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:""===ve.category?g.a.warning({message:"Please provide a category."}):""===ve.contact?g.a.warning({message:"Please provide a contact."}):""===ve.document?g.a.warning({message:"Please provide a document."}):""===ve.matter?g.a.warning({message:"Please provide a matter."}):""===ve.name?g.a.warning({message:"Please provide a name."}):(B(!0),(t=new FormData).set("document",ve.document),t.set("name",ve.name),t.set("matter",ve.matter),t.set("contact",ve.contact),t.set("category",ve.category),t.set("userId",b),console.log(t),i.b.post("/document/upload/934894383948u43",t,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){g.a.success({message:"Document Uploaded."}),st()})).catch((function(e){g.a.error({message:"Document Upload Failed."})})),setTimeout(()=>{q(!1),B(!1)},600));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),rt=function(){var e=Object(s.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.open(t.document);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ct=function(){var e=Object(s.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.b.get("/document/delete/".concat(t)).then(e=>{console.log(e),g.a.success({message:"Document Deleted SuccessFully."}),st()}).catch(e=>{g.a.error({message:"Document Deletion Failed."})});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),it=function(){var e=Object(s.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return we("Edit"),q(!0),e.next=4,i.b.get("/document/view/".concat(t)).then(e=>{De(e.data.data),console.log(ve)});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),mt=function(){var e=Object(s.a)(l.a.mark((function e(){var t,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==ve.category){e.next=4;break}g.a.warning({message:"Please provide a category."}),e.next=29;break;case 4:if(""!==ve.contact){e.next=8;break}g.a.warning({message:"Please provide a contact."}),e.next=29;break;case 8:if(""!==ve.document){e.next=12;break}g.a.warning({message:"Please provide a document."}),e.next=29;break;case 12:if(""!==ve.matter){e.next=16;break}g.a.warning({message:"Please provide a matter."}),e.next=29;break;case 16:if(""!==ve.name){e.next=20;break}g.a.warning({message:"Please provide a name."}),e.next=29;break;case 20:return B(!0),(t=new FormData).set("document",ve.document),t.set("userId",b),i.b.post("/document/edit/".concat(ve._id),t,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{console.log(e)}),a={_id:ve._id,name:ve.name,matter:ve.matter,contact:ve.contact,category:ve.category},e.next=28,i.b.post("/document/edit/".concat(ve._id),a).then((function(e){console.log(e),g.a.success({message:"Document edited."}),st()})).catch((function(e){console.log(e),g.a.error({message:"Document Upload Failed."})}));case 28:setTimeout(()=>{B(!1),q(!1)},600);case 29:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),dt=[{title:"Category Name",dataIndex:"name",key:"1"},{title:"Edit",dataIndex:"edit",key:"6",render:(e,t)=>c.a.createElement(p.a,{className:"btn-outline-info ",onClick:()=>{pt(t)}},"Edit")},{title:"Delete",dataIndex:"delete",key:"7",render:(e,t)=>c.a.createElement(y.a,{title:"Are you sure delete this Catagory?",onConfirm:()=>ut(t._id),onCancel:()=>{},okText:"Yes",cancelText:"No"},c.a.createElement(p.a,{className:" btn-outline-danger "},"Delete"))}],ut=function(){var e=Object(s.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.b.get("/document/category/delete/".concat(t)).then(e=>{g.a.success({message:"Catagory Deleted SuccessFully."}),ht()}).catch(e=>{g.a.error({message:"Catagory Deletion Failed."})});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),pt=e=>{we("Edit"),Se(!0),me(e)},ht=()=>{let e=[];i.b.get("/document/category/viewforuser/".concat(b)).then(t=>{Be(t.data.data),console.log(t),t.data.data.map((t,a)=>{const n={name:t.name,key:a,_id:t._id,userId:b};e.push(n)}),ye(e)})},bt=()=>{""===ie.name?g.a.warning({message:"Please provide a name."}):(B(!0),console.log(ie),i.b.post("/document/category/create/",ie).then((function(e){console.log(e),ht(),g.a.success({message:"Category created."})})).catch((function(e){g.a.error({message:"Failed."})})),setTimeout(()=>{Se(!1),B(!1)},600))},Et=()=>{""===ie.name?g.a.warning({message:"Please provide a name."}):(B(!0),console.log(ie),i.b.post("/document/category/edit/"+ie._id,ie).then((function(e){console.log(e),ht(),g.a.success({message:"Category Edited."})})).catch((function(e){g.a.error({message:"Failed."})})),setTimeout(()=>{Se(!1),B(!1),console.log(ge)},600))},gt={labelCol:{span:8},wrapperCol:{span:16}},yt=e=>new Date(e).toLocaleString(),ft=function(){var e=Object(s.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.b.get("/matter/view/".concat(t)).then(e=>{let t=null!==e.data.data.client?e.data.data.client._id:"-";De(Object(K.a)(Object(K.a)({},ve),{},{contact:t}))});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(r.useEffect)(()=>{st(),ht()},[]);const Ct=c.a.createElement(Z.a,null,c.a.createElement(Z.a.Item,{onClick:()=>{De({document:"",_id:"",name:"",matter:"",category:""}),q(!0),we("Upload")},key:"0"},c.a.createElement("span",null,"Upload File"))),kt=c.a.createElement("div",{className:"d-flex justify-content-center"},c.a.createElement($.a,{overlay:Ct,trigger:["click"]},c.a.createElement(p.a,{className:"ant-dropdown-link",onClick:e=>e.preventDefault()},"Upload ",c.a.createElement(te.a,null)))),St=c.a.createElement("div",{className:"d-flex justify-content-center"},c.a.createElement(p.a,{onClick:()=>Se(!0)},"Add Category")),jt=c.a.createElement("div",{className:"d-flex justify-content-center"},c.a.createElement(p.a,{onClick:()=>{P({document:"",name:"",userId:b,category:""}),T(!0),we("Upload")}},"Upload")),xt=Object(r.useState)(kt),vt=Object(o.a)(xt,2),Dt=vt[0],Nt=vt[1];return c.a.createElement(d.a,{size:"large",spinning:J},c.a.createElement(m.a,{defaultActiveKey:"1",tabBarExtraContent:Dt,onChange:e=>{console.log(e),1==e?Nt(kt):2==e&&Nt(St),3==e&&Nt(jt)},className:"card p-4 overflow-auto"},c.a.createElement(oe,{tab:"Document",key:"1"},c.a.createElement(C.a,{title:" ".concat(Ie," Document"),visible:V,onCancel:()=>q(!1),footer:[c.a.createElement(p.a,{key:"back",onClick:()=>q(!1)},"Cancel"),c.a.createElement(p.a,{key:"submit",type:"primary",htmlType:"submit",disabled:G,onClick:"Upload"===Ie?ot:mt},"Submit")]},c.a.createElement(Q.a,Object.assign({},gt,{name:"basic",fields:[{name:["name"],value:ve.name},{name:["category"],value:ve.category},{name:["matter"],value:"Edit"===Ie?ve.matter._id:ve.matter},{name:["document"]}]}),c.a.createElement(Q.a.Item,{key:"name",label:"Name",name:"name",rules:[{required:!0,message:"Please input name!"}]},c.a.createElement(X.a,{onChange:lt("name"),value:ve.name})),c.a.createElement(Q.a.Item,{key:"matter",label:"Matter",name:"matter",rules:[{required:!0,message:"Please input matter"}]},c.a.createElement(W.a,{showSearch:!0,style:{width:200},placeholder:"Select a Matter",optionFilterProp:"children",onChange:lt("matter"),filterOption:(e,t)=>t.children.toLowerCase().indexOf(e.toLowerCase())>=0},Fe.map((e,t)=>c.a.createElement(se,{key:t,value:e._id},e.matterDescription)))),c.a.createElement(Q.a.Item,{key:"category",label:"Category",name:"category",rules:[{required:!0,message:"Please input category"}]},c.a.createElement(W.a,{showSearch:!0,style:{width:200},placeholder:"Select a Catagory",optionFilterProp:"children",onChange:lt("category"),filterOption:(e,t)=>t.children.toLowerCase().indexOf(e.toLowerCase())>=0},Ge.map((e,t)=>c.a.createElement(se,{key:t,value:e.name},e.name)))),c.a.createElement(Q.a.Item,{key:"document",label:"Document",name:"document",rules:[{required:!0,message:"Please input your File!"}]},c.a.createElement(X.a,{type:"file",onChange:lt("document")})))),c.a.createElement(f.a,{className:"table-responsive",dataSource:0===ze.length&&""===Ve?n:ze,columns:nt})),c.a.createElement(oe,{tab:"Category",key:"2"},(()=>{return c.a.createElement(C.a,{title:" ".concat(Ie," Catagory"),visible:ke,onCancel:()=>Se(!1),footer:[c.a.createElement(p.a,{key:"back",onClick:()=>Se(!1)},"Cancel"),c.a.createElement(p.a,{key:"submit",type:"primary",htmlType:"submit",disabled:G,onClick:"Upload"===Ie?bt:Et},"Submit")]},c.a.createElement(Q.a,Object.assign({},gt,{name:"basic",fields:[{name:["name"],value:ie.name}]}),c.a.createElement(Q.a.Item,{key:"name",label:"Name",name:"name",rules:[{required:!0,message:"Please input name!"}]},c.a.createElement(X.a,{onChange:(e="name",t=>{console.log("chnage"),console.log(e),console.log(t),ie["".concat(e)]=t.target.value,me(Object(K.a)({},ie)),console.log(ie)}),value:ie.name}))));var e})(),c.a.createElement(f.a,{className:"table-responsive",dataSource:ge,columns:dt}))))};class ce extends r.Component{constructor(e){super(e),console.log("data in excel",e.dataSource)}render(){return c.a.createElement("div",null,c.a.createElement("table",{id:"emp",className:"d-none"},c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",null,"Hours"),c.a.createElement("th",null,"Subject"),c.a.createElement("th",null,"Note"),c.a.createElement("th",null,"Date"))),c.a.createElement("tbody",null,this.props.dataSource.map((e,t)=>c.a.createElement("tr",{key:t},c.a.createElement("td",null,e.hours),c.a.createElement("td",null,e.subject),c.a.createElement("td",null,e.notes),c.a.createElement("td",null,e.date))))),c.a.createElement(N.a,{className:"btn btn-outline-primary btn-sm excel-button",table:"emp",filename:"Notes",sheet:"Sheet",buttonText:"Export to Excel"}))}}var ie=ce;var me=e=>{const t=Object(r.useState)(!1),a=Object(o.a)(t,2),n=a[0],l=a[1],s=Object(r.useState)({}),m=Object(o.a)(s,2),b=m[0],E=m[1],k=Object(r.useState)(!1),x=Object(o.a)(k,2),D=x[0],N=x[1],O=Object(h.d)(e=>e.user.token.user._id),I=Object(r.useState)([]),w=Object(o.a)(I,2),T=w[0],L=w[1],F=Object(r.useState)(!1),P=Object(o.a)(F,2),_=P[0],M=P[1],G=Object(r.useState)({}),B=Object(o.a)(G,2),A=B[0],U=B[1],V=Object(r.useState)(!1),q=Object(o.a)(V,2),H=q[0],Y=q[1],z=Object(r.useRef)(null),R=Object(r.useState)(!0),J=Object(o.a)(R,2),K=J[0],W=J[1];let Q="";const X=()=>{console.log(e),i.b.get("/notes/viewforcontact/"+O+"/"+e.id).then(e=>{console.log(e);let t=[];e.data.data.map((e,a)=>{const n={_id:e._id,key:a,notes:e.notes,subject:e.subject,hours:e.hours?e.hours:"-",date:e.date?e.date.substring(0,10):"-"};t.push(n)}),L(t),W(!1)})};Object(r.useEffect)(()=>{X()},[]);const Z=t=>{t.persist(),g.a.destroy();let a=!0;if(""!==Q?(a=!1,g.a.error({message:"Invalid time,  Please enter time in the format : HH:MM:SS"})):""===b.subject||void 0===b.subject?(a=!1,g.a.warning({message:"Please provide a Subject"})):""!==b.notes&&void 0!==b.notes||(a=!1,g.a.warning({message:"Please provide a Note"})),a){N(!0);let t=b;t.userId=O,t.contact=e.id,_?i.b.post("/notes/edit/"+A._id,t).then(e=>{console.log(e),X(),g.a.success({message:"Note Edited."})}).catch(e=>{g.a.error({message:"Failure"})}).then(()=>{v.a.findDOMNode(z.current).reset(),M(!1),Y(!1),E({}),U({}),N(!1)}):i.b.post("/notes/create",t).then(e=>{console.log(e),X(),g.a.success({message:"Note created."})}).catch(e=>{g.a.error({message:"Failure"})}).then(()=>{v.a.findDOMNode(z.current).reset(),l(!1),E({}),U({}),N(!1)})}},$=e=>{M(!1),Y(!1),l(!1),v.a.findDOMNode(z.current).reset()},ee=[{title:"Hours",dataIndex:"hours",key:"1"},{title:"Date",dataIndex:"date",key:"2"},{title:"Subject",dataIndex:"subject",key:"3"},{title:"Note",dataIndex:"notes",key:"4"},{title:"Edit",dataIndex:"edit",key:"5",render:(e,t)=>c.a.createElement(p.a,{onClick:()=>(e=>{M(!0),Y(!0),U(e),E(e),console.log(e)})(t)},"Edit")},{title:"Delete",dataIndex:"delete",key:"5",render:(e,t)=>c.a.createElement(y.a,{title:"Are you sure delete this Note?",onConfirm:()=>(e=>{i.b.get("/notes/delete/"+e._id).then(e=>{console.log(e),X(),g.a.success({message:"Note Deleted !"})}).catch(e=>{g.a.error({message:"Failed to delete"})})})(t),okText:"Yes",cancelText:"No"},c.a.createElement(p.a,{danger:!0},"Delete"))}],te=e=>{e.persist();const t=e.target,a=t.name,n=(t.id,t.value);t.selectedIndex;let l=b;if("hours"===a){Q="";var s=n;if(""==s||s.indexOf(":")<0)Q="Inavlid Time",console.log(Q);else{var o=s.split(":")[0],r=s.split(":")[1],c=s.split(":")[2];console.log(c),""==o||isNaN(o)?(Q="Inavlid Time",console.log(Q)):0==parseInt(o)&&(o="00"),""==r||isNaN(r)||parseInt(r)>59?(Q="Inavlid Time",console.log(Q)):0==parseInt(r)&&(r="00"),""==c||isNaN(c)?(Q="Inavlid Time",console.log(Q)):0==parseInt(c)&&(c="00"),s=o+":"+r+":"+c}l[a]=s}else l[a]=n;E(l),console.log(b)};return c.a.createElement(d.a,{spinning:K,size:"large"},c.a.createElement("div",null,c.a.createElement("div",{className:"d-flex mb-2 title-component-header"},c.a.createElement("div",{className:"title-header-name"},c.a.createElement("h5",null,"Notes")),c.a.createElement("div",{className:"d-flex extra-iteam-div"},c.a.createElement("button",{className:"btn  btn-outline-primary   btn-sm",onClick:()=>{if(console.log(T.length),0==T.length)g.a.warning({message:"Please add notes before exporting"});else{const e="pt",t="A4",a="portrait",n=40,l=new S.a(a,e,t);l.setFontSize(15);const s="Notes",o=[["Hours","Subject","Note","Date"]];let r=[];T.map((e,t)=>{const a=[e.hours,e.subject,e.notes,e.date];r.push(a)});let c={startY:50,head:o,body:r};l.text(s,n,40),l.autoTable(c),l.save("notes.pdf")}}},"Export to Pdf"),c.a.createElement(ie,{dataSource:T||[]}),c.a.createElement("button",{className:"btn  btn-outline-primary   btn-sm",onClick:()=>l(!0)},"Add Notes"))),c.a.createElement(u.a,{className:"mb-4"},c.a.createElement(f.a,{className:"table-responsive",dataSource:T,columns:ee})),c.a.createElement(C.a,{title:"New Note",visible:n,onOk:Z,onCancel:$,footer:[c.a.createElement(p.a,{onClick:$},"Cancel"),c.a.createElement(p.a,{type:"primary",disabled:D,onClick:Z},"Create")]},c.a.createElement(j.a,{id:"myForm",className:"form",ref:z,className:"form-details"},c.a.createElement(j.a.Group,{controlId:"duration"},c.a.createElement(j.a.Label,null,"Hours"),c.a.createElement(j.a.Control,{type:"text",name:"hours",placeholder:"hh:mm:ss",onChange:te})),c.a.createElement(j.a.Group,null,c.a.createElement(j.a.Label,null,"Subject"),c.a.createElement(j.a.Control,{name:"subject",type:"text",placeholder:"Subject",onChange:te})),c.a.createElement(j.a.Group,null,c.a.createElement(j.a.Label,null,"Note"),c.a.createElement(j.a.Control,{name:"notes",as:"textarea",rows:"4",placeholder:"Note",onChange:te})),c.a.createElement(j.a.Group,null,c.a.createElement(j.a.Label,null,"Date"),c.a.createElement(j.a.Control,{name:"date",type:"date",onChange:te})))),c.a.createElement(C.a,{title:"Edit Note",visible:H,onOk:Z,onCancel:$,footer:[c.a.createElement(p.a,{onClick:$},"Cancel"),c.a.createElement(p.a,{type:"primary",disabled:D,onClick:Z},"Save")]},c.a.createElement(j.a,{id:"myForm",className:"form",ref:z,className:"form-details"},c.a.createElement(j.a.Group,{controlId:"duration"},c.a.createElement(j.a.Label,null,"Duration"),c.a.createElement(j.a.Control,{type:"text",name:"hours",defaultValue:A.hours,onChange:te})),c.a.createElement(j.a.Group,null,c.a.createElement(j.a.Label,null,"Subject"),c.a.createElement(j.a.Control,{name:"subject",type:"text",defaultValue:A.subject,onChange:te})),c.a.createElement(j.a.Group,null,c.a.createElement(j.a.Label,null,"Note"),c.a.createElement(j.a.Control,{name:"notes",as:"textarea",rows:"4",defaultValue:A.notes,onChange:te})),c.a.createElement(j.a.Group,null,c.a.createElement(j.a.Label,null,"Date"),c.a.createElement(j.a.Control,{name:"date",type:"date",defaultValue:A.date,onChange:te}))))))};const de=m.a.TabPane;t.default=function(e){let t={},a=null;const n=Object(r.useState)(""),g=Object(o.a)(n,2),y=g[0],f=g[1],C=Object(r.useState)(!0),k=Object(o.a)(C,2),S=k[0],j=k[1],x=(Object(h.d)(e=>e.user.token.user._id),Object(r.useState)()),v=Object(o.a)(x,2),D=v[0],N=v[1],O=Object(r.useState)(),I=Object(o.a)(O,2),w=I[0],T=I[1],L=Object(r.useState)(),F=Object(o.a)(L,2),P=F[0],_=F[1],M=Object(r.useState)(""),G=Object(o.a)(M,2),B=G[0],A=G[1],U=Object(r.useState)(),V=Object(o.a)(U,2),H=V[0],Y=V[1],z=Object(r.useState)(),R=Object(o.a)(z,2),K=R[0],W=R[1],Q=Object(r.useState)(),X=Object(o.a)(Q,2),Z=X[0],$=X[1],ee=Object(r.useState)(),te=Object(o.a)(ee,2),ae=te[0],ne=te[1],le=Object(r.useState)({}),se=Object(o.a)(le,2),oe=se[0],ce=se[1];Object(r.useEffect)(()=>{function a(){return(a=Object(s.a)(l.a.mark((function a(){return l.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,i.b.get("/contact/view/"+e.location.state).then(e=>{t=e.data.data,console.log(t),ie(),ce(t)});case 2:case"end":return a.stop()}}),a)})))).apply(this,arguments)}console.log(e.location.state),function(){a.apply(this,arguments)}()},[]);const ie=()=>{const e=t.firstName+" "+t.lastName,n=t.image;a=t;const l=t.billingClientId,s=t.billingCustomRate,o=t.address.map((e,t)=>c.a.createElement("div",{className:"table-span-light",key:t},c.a.createElement("p",{style:{"font-size":"15px"}},e.type),c.a.createElement("p",null,e.street),c.a.createElement("p",null,e.city),c.a.createElement("p",null,e.state),c.a.createElement("p",null,e.zipCode),c.a.createElement("p",null,e.country))),r=t.website.map((e,t)=>c.a.createElement("div",{className:"table-span-light",key:t},c.a.createElement("p",null,e.websiteType," : ",e.website))),i=t.emailAddress.map((e,t)=>c.a.createElement("div",{className:"table-span-light",key:t},c.a.createElement("p",null,e.emailType," : ",e.emailAddress))),m=t.phone.map((e,t)=>c.a.createElement("div",{className:"table-span-light",key:t},c.a.createElement("p",null,e.phoneType," : ",e.phone)));f(n),N(o),_(l),ne(s),T(e),W(i),$(m),Y(r),A(t._id),j(!1)};return c.a.createElement(c.a.Fragment,null,c.a.createElement(d.a,{size:"large",spinning:S},c.a.createElement(m.a,{defaultActiveKey:"1"},c.a.createElement(de,{tab:"Dashboard",key:"1",style:{padding:"0px"}},c.a.createElement("div",{className:"d-flex flex-wrap mb-3"},c.a.createElement("div",null,c.a.createElement("h3",null,w)),c.a.createElement("div",{className:"green-span"},c.a.createElement("p",null,"Client"))),c.a.createElement("div",{className:"d-flex flex-wrap"},c.a.createElement(u.a,{extra:c.a.createElement(p.a,{type:"link",onClick:()=>e.history.push("/edit/contact",oe)},"Edit"),title:"Contact Details",className:"m-2 card-box"},c.a.createElement(b.a,null,c.a.createElement(E.a,{sm:!0},c.a.createElement("img",{height:"200",width:"200",src:y,alt:"No image"}))),c.a.createElement(b.a,{className:"py-2"},c.a.createElement(E.a,{sm:!0},c.a.createElement("span",{className:"table-span-dark"},"Name")),c.a.createElement(E.a,{sm:!0},c.a.createElement("span",{className:"table-span-light"},w))),c.a.createElement(b.a,{className:"py-2"},c.a.createElement(E.a,{sm:!0},c.a.createElement("span",{className:"table-span-dark"},"Email Address")),c.a.createElement(E.a,{sm:!0},c.a.createElement("span",{className:"table-span-light"},K))),c.a.createElement(b.a,{className:"py-2"},c.a.createElement(E.a,{sm:!0},c.a.createElement("span",{className:"table-span-dark"},"Phone Number")),c.a.createElement(E.a,{sm:!0},c.a.createElement("span",{className:"table-span-light"},Z))),c.a.createElement(b.a,{className:"py-2"},c.a.createElement(E.a,{sm:!0},c.a.createElement("span",{className:"table-span-dark"},"Website")),c.a.createElement(E.a,{sm:!0},c.a.createElement("span",{className:"table-span-light"},H))),c.a.createElement(b.a,{className:"py-2"},c.a.createElement(E.a,{sm:!0},c.a.createElement("span",{className:"table-span-dark"},"Address")),c.a.createElement(E.a,{sm:!0},c.a.createElement("span",{className:"table-span-light"},D)))),c.a.createElement(u.a,{title:"Billing Information",className:"m-2 card-box"},c.a.createElement(b.a,{className:"py-2"},c.a.createElement(E.a,{sm:!0},c.a.createElement("span",{className:"table-span-dark"},"ID")),c.a.createElement(E.a,{sm:!0},c.a.createElement("span",{className:"table-span-light"},P))),c.a.createElement(b.a,{className:"py-2"},c.a.createElement(E.a,{sm:!0},c.a.createElement("span",{className:"table-span-dark"},"Rate")),c.a.createElement(E.a,{sm:!0},c.a.createElement("span",{className:"table-span-light"},ae)))))),c.a.createElement(de,{tab:"Communication",key:"4"},c.a.createElement(q,{id:B})),c.a.createElement(de,{tab:"Notes",key:"6"},c.a.createElement(me,{id:B})),c.a.createElement(de,{tab:"Document",key:"7"},c.a.createElement(re,{id:B,matters:e.location.state.matters,userId:e.location.state.userId,matterId:e.location.state.id})),c.a.createElement(de,{tab:"Bills",key:"9"},c.a.createElement(J,{handleRecordPayment:()=>{e.history.push("/manage/billing/record")},handleBills:t=>{console.log(e),e.history.push("/create/bills")},id:B})),c.a.createElement(de,{tab:"Transactions",key:"10"}))))}}}]);
//# sourceMappingURL=50.7897d8d3.chunk.js.map