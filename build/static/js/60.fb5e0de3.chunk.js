(this["webpackJsonpdatta-able-rv18.0.4"]=this["webpackJsonpdatta-able-rv18.0.4"]||[]).push([[60],{596:function(e,t,a){"use strict";a.r(t);var n=a(225),l=a.n(n),s=a(226),o=a(1),r=a(0),i=a.n(r),c=a(999),m=a(728),d=a(482),u=a(110),p=a(1001),h=a(996),E=a(3),C=a(590),g=a(591),b=a(8);const f=RegExp(/^[ ',-\.A-Za-z\xC0-\xCF\xD1-\xD6\xD8-\xDD\xDF-\xE5\xE7-\xF6\xF8-\xFD\xFF\u0104-\u0107\u010C\u010D\u0116-\u0119\u012E\u012F\u0141-\u0144\u0152\u0160\u0161\u016A\u016B\u0172\u0173\u0178-\u017E\u2202]+$/);let D={},v={},F=null,x=!0,k="",I=[],N=0,S={relationship:[""]};class y extends i.a.Component{constructor(e){super(e),this.handleChange=e=>{e.persist(),this.setState(t=>Object(o.a)(Object(o.a)({},t),{},{[e.target.name]:e.target.value})),"client"===e.target.name&&(N=e.target.selectedIndex-1)},this.addFeild=()=>{let e=this.state.relatedContacts;e.push({relationship:"",contact:"",billThis:"",id:""}),this.setState({relatedContacts:e})},this.handleDelete=e=>{e.persist();const t=e.target,a=(t.name,t.id);let n=this.state;n.relatedContacts.splice(a,1),this.setState(n)},this.HandleDynamicChange=e=>{e.persist();let t=this.state;const a=e.target,n=a.id,l=a.value,s=a.name,o=a.checked,r=a.selectedIndex;switch("billThis"===s&&(t.relatedContacts[n][s]=o),"contact"===s?(console.log(v),0!=r&&(t.relatedContacts[n][s]=v.data.data[r-1]._id,t.relatedContacts[n].id=r)):t.relatedContacts[n][s]=l,console.log(S.relationship),s){case"relationship":S.relationship[n]=f.test(l)?l.length>20?"Relationship must be less than 20 characters long!":"":"Realtionship must be in characters!"}this.setState(t),console.log(this.state)},this.openNotificationWithIcon=e=>{u.a[e]({message:"Matter Saved"})},this.openNotificationWithfailure=e=>{u.a[e]({message:"Failure"})},this.handleSubmit=e=>{if(e.preventDefault(),u.a.destroy(),""===this.state.matterDescription||void 0===this.state.matterDescription)return u.a.warning({message:"Please add a matter description"});if(""===this.state.client||void 0===this.state.client)return u.a.warning({message:"Please select a contact"});{const e=this.state;e.customFields=I,e.client=v.data.data[N]._id,e.userId=this.props.userId,x?E.b.post("/matter/edit/"+this.props.location.state,e).then(e=>{console.log(e),this.openNotificationWithIcon("success"),void 0!=this.props.location&&this.props.history.goBack()}).catch(()=>{this.openNotificationWithfailure("error")}):E.b.post("/matter/create",e).then(e=>console.log(e)).then(()=>this.openNotificationWithIcon("success")).catch(()=>this.openNotificationWithfailure("error"))}},this.state={rate:"Flat",status:"Open",editData:{},client:"",relatedContacts:[],customFields:[],modal:!1,taskOptions:[]}}handleCustom(e){e.persist();const t=e.target,a=t.id,n=t.value,l=t.name;I[a]={[l]:n}}componentDidMount(){var e=this;return Object(s.a)(l.a.mark((function t(){var a,n,s,o,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,E.b.get("/matter/view/"+e.props.location.state);case 2:return a=t.sent,console.log(a),e.setState({editData:a.data.data,matterDescription:a.data.data.matterDescription,relatedContacts:a.data.data.relatedContacts?a.data.data.relatedContacts:[]}),e.setState({client:a.data.data.client._id}),n=[],E.b.get("/tasks/viewforuser/"+e.props.userId).then(t=>{console.log(t),t.data.data.map((e,t)=>{n.push(i.a.createElement("option",{value:e._id},e.taskName))}),e.setState({taskOptions:n});const a=i.a.createElement(c.a,{className:"form-details"},i.a.createElement(c.a.Group,{controlId:"exampleForm.ControlSelect1"},i.a.createElement(c.a.Label,null,"Task"),i.a.createElement(c.a.Control,{as:"select",name:"task",onChange:e.handleChange,defaultValue:e.state.editData.task?e.state.editData.task[0]:""},i.a.createElement("option",null,"Select a task"),e.state.taskOptions.map(e=>e))));e.setState({taskAutomation:a})}),E.b.get("/user/view/"+e.props.userId).then(t=>{console.log(t);let n=[];t.data.data.customFields.map((t,l)=>{n.push(i.a.createElement(m.a,{md:"6"},i.a.createElement(c.a.Group,{key:l,controlId:l},i.a.createElement(c.a.Label,null,t.name),i.a.createElement(c.a.Control,{name:t.name,type:t.type,defaultValue:0==a.data.data.customFields.length||void 0==a.data.data.customFields[l]?" ":a.data.data.customFields[l][t.name],onChange:e.handleCustom})))),console.log(a.data.data.customFields)}),e.setState({customFields:n})}),"/manage/Matter/edit"===e.props.location.pathname&&(x=!0,k=e.props.location.state),t.t0=E.b.get("/user/view/"+e.props.userId),t.next=13,E.b.get("contact/viewforuser/"+e.props.userId);case 13:return t.t1=v=t.sent,t.next=16,t.t0.then.call(t.t0,t.t1);case 16:D=t.sent,F=v.data.data.map((e,t)=>i.a.createElement("option",{value:e._id,id:t},e.firstName+" "+e.lastName)),s=i.a.createElement("div",null,i.a.createElement(c.a.Group,{controlId:"exampleForm.ControlSelect1"},i.a.createElement(c.a.Label,null,"Client"),i.a.createElement(c.a.Control,{as:"select",name:"client",defaultValue:e.state.editData.client._id,onChange:e.handleChange},i.a.createElement("option",null,"Select a contact"),F)),i.a.createElement("div",{className:"form-add mb-4"},i.a.createElement("span",{onClick:()=>e.setState({modal:!0})},"Add Contact")),i.a.createElement(c.a.Group,{controlId:"exampleForm.ControlSelect1"},i.a.createElement(c.a.Label,null,"Practise Area"),i.a.createElement(c.a.Control,{as:"select",name:"practiseArea",onChange:e.handleChange,defaultValue:e.state.editData.practiseArea},i.a.createElement("option",null,"Select a practice area"),i.a.createElement("option",null,"Attorney"),i.a.createElement("option",null,"Administrative"),i.a.createElement("option",null,"Bankruptcy"),i.a.createElement("option",null,"Business"),i.a.createElement("option",null,"Builder's Liens"),i.a.createElement("option",null,"Civil Litigation"),i.a.createElement("option",null,"Commercial"),i.a.createElement("option",null,"Conveyance (Purchase)"),i.a.createElement("option",null,"Conveyance (Sale)"),i.a.createElement("option",null,"Corporate"),i.a.createElement("option",null,"Criminal"),i.a.createElement("option",null,"Employment"),i.a.createElement("option",null,"Estates"),i.a.createElement("option",null,"Family"),i.a.createElement("option",null,"Immigration"),i.a.createElement("option",null,"Insurance"),i.a.createElement("option",null,"Personal Injury"),i.a.createElement("option",null,"Tax"),i.a.createElement("option",null,"Wills"))),i.a.createElement(c.a.Group,{controlId:"exampleForm.ControlSelect1"},i.a.createElement(c.a.Label,null,"Status"),i.a.createElement(c.a.Control,{as:"select",name:"status",onChange:e.handleChange,defaultValue:e.state.editData.status},i.a.createElement("option",null,"Open"),i.a.createElement("option",null,"Closed"),i.a.createElement("option",null,"Pending"))),i.a.createElement(c.a.Row,{className:"matter-res-date"},i.a.createElement(m.a,{sm:!0},i.a.createElement(c.a.Group,{controlId:"formGroupOpenDate"},i.a.createElement(c.a.Label,null,"Open Date"),i.a.createElement(c.a.Control,{name:"openDate",type:"Date",defaultValue:e.state.editData.openDate,onChange:e.handleChange}))),i.a.createElement(m.a,{sm:!0},i.a.createElement(c.a.Group,{controlId:"formGroupClosing Date"},i.a.createElement(c.a.Label,null,"Closing Date"),i.a.createElement(c.a.Control,{name:"closeDate",type:"Date",defaultValue:e.state.editData.closeDate,onChange:e.handleChange}))),i.a.createElement(m.a,{sm:!0},i.a.createElement(c.a.Group,{controlId:"formGroupPendingDate"},i.a.createElement(c.a.Label,null,"Pending Date"),i.a.createElement(c.a.Control,{name:"pendingDate",type:"Date",defaultValue:e.state.editData.pendingDate,onChange:e.handleChange}))))),o=i.a.createElement(c.a,{className:"form-details"},i.a.createElement(g.a,{name:"realtedContacts",InputList:e.state.relatedContacts,option:F,error:S.relationship,change:e.HandleDynamicChange,delete:e.handleDelete,editMode:x}),i.a.createElement("br",null),i.a.createElement("div",{className:"form-add mb-4"},i.a.createElement("span",{onClick:e.addFeild},"Add Related Contact"))),r=i.a.createElement(c.a,{className:"form-details"},i.a.createElement(c.a.Group,{controlId:"exampleForm.ControlSelect1"},i.a.createElement(c.a.Label,null,"Rate"),i.a.createElement(c.a.Control,{as:"select",name:"billingType",onChange:e.handleChange,defaultValue:e.state.editData.billingType},i.a.createElement("option",null,"Flat"),i.a.createElement("option",null,"Hourly"),i.a.createElement("option",null,"Contagious")))),e.setState({formData:s,contactForm:o,billing:r}),e.setState({optns:F});case 23:case"end":return t.stop()}}),t)})))()}render(){const e=e=>{e.persist(),"client"===e.target.name?N=e.target.selectedIndex-1:"task"===e.target.name?0!=e.target.selectedIndex&&this.setState(t=>Object(o.a)(Object(o.a)({},t),{},{[e.target.name]:e.target.value})):this.setState(t=>Object(o.a)(Object(o.a)({},t),{},{[e.target.name]:e.target.value}))};return i.a.createElement("div",{className:"form-width"},i.a.createElement("div",{className:"form-header-container mb-4"},i.a.createElement("h3",{className:"form-header-text"},"Edit Matter")),i.a.createElement(p.a,{title:"Matter Information",className:"mb-4"},i.a.createElement(c.a,{className:"form-details"},i.a.createElement(c.a.Group,{controlId:"formGroupMatter"},i.a.createElement(c.a.Label,null,"Matter Description"),i.a.createElement(c.a.Control,{required:!0,name:"matterDescription",as:"textarea",rows:"3",type:"text",defaultValue:this.state.editData.matterDescription,onChange:e})),this.state.formData,i.a.createElement(c.a.Group,{controlId:"formGroupClientRefenceNumber"},i.a.createElement(c.a.Label,null,"Client reference number"),i.a.createElement(c.a.Control,{name:"clientReferenceNumber",type:"number",defaultValue:this.state.editData.clientReferenceNumber,onChange:e})))),i.a.createElement(p.a,{title:"Related Contacts",className:"mb-4"},this.state.contactForm),i.a.createElement(p.a,{title:"Custom Fields",className:"mb-4"},i.a.createElement(c.a,{className:"form-details"},i.a.createElement("p",null,"Customise your",i.a.createElement(d.a,{variant:"link",onClick:()=>this.props.history.push("/settings/customFeilds")},"Custom Fields")),this.state.customFields.map(e=>e))),i.a.createElement(p.a,{title:"Billing Preference",className:"mb-4"},this.state.billing),i.a.createElement(p.a,{title:"Task Automation",className:"mb-4"},this.state.taskAutomation),i.a.createElement(d.a,{onClick:this.handleSubmit,className:"btn btn-success"},"Update"),i.a.createElement(d.a,{onClick:()=>{this.props.history.goBack()}},"CANCEL"),i.a.createElement("br",null),i.a.createElement(h.a,{centered:!0,visible:this.state.modal,onOk:()=>this.setState({modal:!1}),onCancel:()=>this.setState({modal:!1})},i.a.createElement(C.a,null)))}}t.default=Object(b.b)(e=>({userId:e.user.token.user._id}))(y)}}]);
//# sourceMappingURL=60.fb5e0de3.chunk.js.map